<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">

	<resultMap id="memberResultSet" type="member">
		<result column="MEM_NO" property="memNo"/>
		<result column="MEM_ID" property="memId"/>
		<result column="MEM_PWD" property="memPwd"/>
		<result column="NAME" property="name"/>
		<result column="NICKNAME" property="nickName"/>
		<result column="PHONE" property="phone"/>
		<result column="GENDER" property="gender"/>
		<result column="EMAIL" property="email"/>
		<result column="ENROLL_DATE" property="enrollDate"/>
		<result column="MEM_STATUS" property="memStatus"/>
		<result column="FARMER_CODE" property="farmerCode"/>
		<result column="CAREER" property="career"/>
		<result column="MODIFY_DATE" property="modifyDate"/>		
	</resultMap>
	
	<resultMap id="boardResultSet" type="board">
		<result column="board_no"      property="boardNo" />
		<result column="board_type"   property="boardType" />
		<result column="board_title"  property="boardTitle" />
		<result column="board_content"  property="boardContent" />
		<result column="create_date"   property="createDate" />
		<result column="modify_date"   property="modifyDate" />
		<result column="thumbnail"   property="thumbnail" />
		<result column="recruit_yn"   property="recruitYN" />
		<result column="count"         property="count" />
		<result column="status"   property="status" />
		<result column="mem_no" property="memNo" />
		<result column="board_writer" property="boardWriter" />
		<result column="board_like" property="boardLike" />
	</resultMap>

	<!-- 로그인 -->
	<select id="loginMember" parameterType="member" resultMap="memberResultSet">
		SELECT MEM_NO, MEM_ID, MEM_PWD, NAME, NICKNAME, PHONE, GENDER, EMAIL, ENROLL_DATE, MEM_STATUS, FARMER_CODE, CAREER
		FROM MEMBER
		WHERE MEM_ID = #{memId}
		AND MEM_STATUS = 'Y'
	</select>

	<!-- 일반 사용자 회원가입 -->
	<insert id="userInsertMember" parameterType="member">
		INSERT INTO MEMBER(MEM_NO, MEM_ID, MEM_PWD, NAME, NICKNAME, PHONE, GENDER, EMAIL, ENROLL_DATE, MEM_STATUS)
		VALUES(SEQ_MNO.NEXTVAL, #{memId}, #{memPwd}, #{name}, #{nickName}, #{phone}, #{gender}, #{email}, SYSDATE, 'Y')
	</insert>
	
	<!-- 농부 회원가입 -->
	<insert id="farmerInsertMember" parameterType="member">
		INSERT INTO MEMBER(MEM_NO, MEM_ID, MEM_PWD, NAME, NICKNAME, PHONE, GENDER, EMAIL, ENROLL_DATE, MEM_STATUS, FARMER_CODE, CAREER)
		VALUES(SEQ_MNO.NEXTVAL, #{memId}, #{memPwd}, #{name}, #{nickName}, #{phone}, #{gender}, #{email}, SYSDATE, 'Y', #{farmerCode}, #{career})
	</insert>
	
	<!-- 일반 사용자 정보 수정 -->
	<update id="updateUser" parameterType="member">
		UPDATE MEMBER
		SET NAME = #{name}, EMAIL = #{email}, NICKNAME = #{nickName}, PHONE = #{phone}, MODIFY_DATE = SYSDATE
		WHERE MEM_ID = #{memId}
		AND MEM_STATUS = 'Y'
	</update>
	
	<!-- 농부 정보 수정 -->
	<update id="updateFarmer" parameterType="member">
		UPDATE MEMBER
		SET NAME = #{name}, EMAIL = #{email}, NICKNAME = #{nickName}, PHONE = #{phone}, MODIFY_DATE = SYSDATE, FARMER_CODE = #{farmerCode}, CAREER = #{career}
		WHERE MEM_ID = #{memId}
		AND MEM_STATUS = 'Y'
	</update>
	
	<!-- 일반 사용자 탈퇴 -->
	<update id="deleteUser" parameterType="String">
		UPDATE MEMBER
		SET MEM_STATUS = 'N'
		WHERE MEM_ID = #{memId}
	</update>
	
	<!-- 농부 탈퇴 -->
	<update id="deleteFarmer" parameterType="String">
		UPDATE MEMBER
		SET MEM_STATUS = 'N'
		WHERE MEM_ID = #{memId}
	</update>
	
	<!-- 아이디 중복 체크 -->
	<select id="idCheck" resultType="_int">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE MEM_ID = #{memId}
	</select>
	
	<!-- 내가 작성한 게시글 조회 -->
	<select id="userMyBoardList" resultMap="boardResultSet" parameterType="board">
		SELECT BOARD_NO, BOARD_TYPE, BOARD_TITLE, BOARD_CONTENT, CREATE_DATE, MODIFY_DATE, THUMBNAIL, RECRUIT_YN, COUNT, STATUS, MEM_NO
		FROM BOARD
		WHERE MEM_NO = #{memNo}
		AND STATUS = 'Y'
	</select>
	
	<!-- 농부가 작성한 게시글 조회 -->
	<select id="farmerMyBoardList" resultMap="boardResultSet" parameterType="board">
		SELECT BOARD_NO, BOARD_TYPE, BOARD_TITLE, BOARD_CONTENT, CREATE_DATE, MODIFY_DATE, THUMBNAIL, RECRUIT_YN, COUNT, STATUS, MEM_NO
		FROM BOARD
		WHERE MEM_NO = #{memNo}
		AND STATUS = 'Y'
	</select>
	
	<!-- 아이디 찾기 -->
	<!--<select id="findId" parameterType="member" resultType="memberResultSet">
		SELECT MEM_ID
		FROM MEMBER
		WHERE MEM_PWD = #{ memPwd }
		AND MEM_STATUS = 'Y'
	</select>	 -->
</mapper>
